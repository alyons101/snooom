<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SNOOOM — Vintage varsity. Modern comfort.</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
  <style>
    :root {
      --navy: #050c1c;
      --navy-mid: #0d1731;
      --navy-light: #142140;
      --gold: #d8b46d;
      --cream: #f4f0e7;
      --muted: rgba(247, 249, 255, 0.7);
      --text: #f7f9ff;
      --shadow-base: 0 15px 35px rgba(4, 6, 18, 0.55);
      --shadow-hover: 0 25px 55px rgba(0, 0, 0, 0.6);
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Space Grotesk', sans-serif;
      background: var(--navy);
      color: var(--text);
      line-height: 1.7;
      scroll-behavior: smooth;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(20, 35, 66, 0.5), rgba(5, 12, 28, 0.95)),
        repeating-linear-gradient(135deg, rgba(255, 255, 255, 0.035) 0 2px, transparent 2px 6px);
      pointer-events: none;
      z-index: -2;
    }
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(0deg, rgba(255, 255, 255, 0.03) 0 1px, transparent 1px 3px);
      mix-blend-mode: soft-light;
      opacity: 0.15;
      pointer-events: none;
      z-index: -1;
    }
    img {
      max-width: 100%;
      display: block;
    }
    a {
      color: var(--gold);
      text-decoration: none;
    }
    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
      background: rgba(4, 10, 24, 0.92);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(216, 180, 109, 0.35);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.35);
    }
    nav {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem 2rem 0.85rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.5rem;
    }
    .logo {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      position: relative;
      overflow: hidden;
    }
    .logo::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, transparent 10%, rgba(255, 255, 255, 0.35) 45%, transparent 70%);
      transform: translateX(-120%);
      opacity: 0;
      transition: transform 0.6s ease, opacity 0.6s ease;
      pointer-events: none;
    }
    .logo:hover::after {
      transform: translateX(120%);
      opacity: 1;
    }
    .logo-img {
      height: 46px;
      width: auto;
      display: block;
      filter: drop-shadow(0 10px 25px rgba(0, 0, 0, 0.6));
    }
    .nav-links {
      display: flex;
      gap: 1.25rem;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    .nav-links a {
      position: relative;
      padding-bottom: 0.25rem;
      color: var(--text);
    }
    .nav-links a::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
      transform: scaleX(0);
      transform-origin: center;
      transition: transform 0.3s ease;
    }
    .nav-links a:hover::after {
      transform: scaleX(1);
    }
    main {
      margin-top: 100px;
    }
    section {
      padding: clamp(3.5rem, 8vw, 5rem) 1.5rem;
    }
    .hero {
      min-height: calc(100vh - 90px);
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      align-items: center;
      gap: 3rem;
      max-width: 1200px;
      margin: 0 auto;
    }
    .hero-text h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(3.4rem, 6.4vw, 5.4rem);
      line-height: 1.05;
      margin-bottom: 1rem;
      letter-spacing: -0.01em;
      text-shadow: 0 20px 50px rgba(0, 0, 0, 0.55);
    }
    .hero-label {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.25em;
      font-size: 0.8rem;
      color: var(--muted);
      padding: 0.4rem 0.8rem;
      border: 1px solid rgba(216, 180, 109, 0.4);
      border-radius: 999px;
      margin-bottom: 1rem;
    }
    .hero-label::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--gold);
    }
    .tagline {
      font-size: 1.05rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--muted);
      margin-bottom: 1.25rem;
    }
    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .btn {
      border: 1px solid rgba(255, 255, 255, 0.15);
      padding: 0.9rem 2.2rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      font-size: 0.85rem;
      color: var(--text);
      background: rgba(255, 255, 255, 0.03);
      border-radius: 999px;
      transition: transform 0.35s ease, box-shadow 0.35s ease, background 0.35s ease, color 0.35s ease;
      box-shadow: var(--shadow-base);
      position: relative;
      overflow: hidden;
    }
    .btn.primary {
      background: linear-gradient(135deg, #f7d18b, var(--gold));
      color: var(--navy);
      border: none;
      font-weight: 600;
      box-shadow: 0 25px 45px rgba(216, 180, 109, 0.4);
    }
    .btn:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: var(--shadow-hover);
    }
    .btn .ripple {
      position: absolute;
      border-radius: 50%;
      transform: scale(0);
      background: rgba(255, 255, 255, 0.35);
      animation: ripple 0.6s ease-out;
      pointer-events: none;
    }
    @keyframes ripple {
      to {
        transform: scale(12);
        opacity: 0;
      }
    }
    .hero-image {
      position: relative;
      text-align: center;
      isolation: isolate;
    }
    .hero-image::before {
      content: '';
      position: absolute;
      inset: 10%;
      background: radial-gradient(circle, rgba(247, 209, 139, 0.3), transparent 60%);
      filter: blur(30px);
      z-index: -1;
    }
    .hero-image img {
      width: 100%;
      max-width: 440px;
      margin: 0 auto;
      filter: drop-shadow(0 30px 80px rgba(0, 0, 0, 0.55));
      border-radius: 28px;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.08), transparent 70%);
      transition: transform 0.6s ease, filter 0.6s ease;
    }
    .hero-image:hover img {
      transform: scale(1.02);
      filter: drop-shadow(0 45px 90px rgba(0, 0, 0, 0.65));
    }
    .hoodie-breathe img {
      animation: hoodieBreath 4s ease-in-out infinite;
    }
    @keyframes hoodieBreath {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.01); }
    }
    .floating-section {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 3rem;
      align-items: center;
    }
    .floating-image {
      position: relative;
    }
    .floating-image img {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      filter: drop-shadow(0 40px 70px rgba(0, 0, 0, 0.6));
      transition: transform 0.6s ease;
      border-radius: 32px;
      box-shadow: 0 0 60px rgba(216, 180, 109, 0.25);
      background: radial-gradient(circle, rgba(255, 255, 255, 0.04), transparent 60%);
    }
    .floating-copy h2 {
      font-size: 2.3rem;
      margin-bottom: 1rem;
    }
    .drop-badge {
      display: inline-block;
      margin: 1rem 0 1.5rem;
      padding: 0.5rem 1.2rem;
      border: 1px solid rgba(216, 180, 109, 0.6);
      border-radius: 999px;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: rgba(255, 255, 255, 0.03);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
    }
    .size-selector {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    .size-selector button {
      border: none;
      padding: 0.45rem 1.2rem;
      border-radius: 999px;
      background: rgba(244, 240, 231, 0.2);
      color: var(--navy);
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
      transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
      cursor: pointer;
    }
    .size-selector button:hover,
    .size-selector button:focus {
      background: rgba(244, 240, 231, 0.35);
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 18px 35px rgba(0, 0, 0, 0.35);
      outline: none;
    }
    .quantity-selector {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      padding: 0.5rem 1rem;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.03);
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
    }
    .qty-btn {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(244, 240, 231, 0.15);
      color: var(--text);
      font-size: 1.2rem;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
    }
    .qty-btn:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.45);
      background: rgba(244, 240, 231, 0.25);
    }
    .qty-number {
      font-size: 1.2rem;
      letter-spacing: 0.08em;
    }
    .floating-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .gallery-thumbs {
      display: grid;
      grid-template-columns: repeat(4, minmax(60px, 1fr));
      gap: 0.75rem;
      margin-top: 2rem;
    }
    .gallery-thumbs img,
    .closeup-grid img,
    .about-content img {
      border-radius: 18px;
      box-shadow: var(--shadow-base);
      transition: transform 0.35s ease, box-shadow 0.35s ease;
      cursor: pointer;
    }
    .gallery-thumbs img:hover,
    .closeup-grid img:hover,
    .about-content img:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: var(--shadow-hover);
    }
    .section-title {
      font-size: 2.3rem;
      margin-bottom: 2.5rem;
      position: relative;
      display: inline-flex;
      gap: 0.75rem;
      align-items: center;
    }
    .section-title::after {
      content: '';
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--gold), transparent);
      transition: width 0.4s ease;
    }
    .section-title.visible::after {
      width: 64px;
    }
    .showcase,
    .closeup,
    .details,
    .size-guide,
    .about,
    .testimonials,
    .drop,
    .ceo-section {
      max-width: 1200px;
      margin: 0 auto;
    }
    .showcase img {
      border-radius: 28px;
      box-shadow: var(--shadow-base);
    }
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
    }
    .card,
    .testimonial-card,
    .field-note-card,
    .drop form,
    .about-content img,
    .closeup-grid img,
    .gallery-thumbs img {
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }
    .card {
      padding: 1.75rem;
      border-radius: 22px;
      box-shadow: var(--shadow-base);
      transition: transform 0.35s ease, box-shadow 0.35s ease;
    }
    .card:hover {
      transform: translateY(-4px) scale(1.02);
      box-shadow: var(--shadow-hover);
    }
    .closeup-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.25rem;
    }
    .details-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }
    .tab-btn {
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: transparent;
      color: var(--text);
      padding: 0.6rem 1.2rem;
      border-radius: 999px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      cursor: pointer;
      transition: background 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
    }
    .tab-btn.active,
    .tab-btn:hover {
      background: rgba(216, 180, 109, 0.15);
      color: var(--gold);
      box-shadow: 0 12px 28px rgba(216, 180, 109, 0.25);
    }
    .tab-content {
      background: rgba(6, 9, 24, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 20px;
      padding: 1.75rem;
      box-shadow: var(--shadow-base);
    }
    .tab-content ul {
      list-style: none;
      padding-left: 1rem;
    }
    .tab-content li {
      position: relative;
      padding-left: 1rem;
      margin-bottom: 0.5rem;
    }
    .tab-content li::before {
      content: '—';
      position: absolute;
      left: 0;
      color: var(--gold);
    }
    .size-guide .card table {
      width: 100%;
      border-collapse: collapse;
      text-align: left;
    }
    .size-guide .card th,
    .size-guide .card td {
      padding: 0.55rem 0.35rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    }
    .size-guide .card th {
      color: var(--gold);
      font-weight: 600;
    }
    .about-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 2rem;
      align-items: center;
    }
    .about-content img {
      width: 100%;
    }
    .testimonials {
      display: grid;
      gap: 2.5rem;
    }
    .field-notes-wrapper {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      align-items: center;
    }
    .field-note-stack-wrapper {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }
    .notes-progress-bar {
      width: 100%;
      height: 4px;
      background: rgba(255, 255, 255, 0.12);
      border-radius: 999px;
      margin-top: 1.5rem;
      overflow: hidden;
    }
    .notes-progress-fill {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, rgba(247, 209, 139, 0.9), rgba(216, 180, 109, 0.7));
    }
    .notes-progress-fill.animating {
      animation: notesProgress 6.5s linear forwards;
    }
    @keyframes notesProgress {
      from { width: 0; }
      to { width: 100%; }
    }
    .field-notes-visual img {
      border-radius: 28px;
      box-shadow: var(--shadow-base);
      cursor: pointer;
    }
    .field-note-stack {
      position: relative;
      min-height: 320px;
    }
    .field-note-card {
      position: absolute;
      inset: 0;
      padding: 2rem;
      border-radius: 26px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(8, 12, 28, 0.8);
      opacity: 0;
      transform: translateY(15px);
      pointer-events: none;
      transition: opacity 0.45s ease, transform 0.45s ease;
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
      box-shadow: var(--shadow-base);
    }
    .field-note-card.active {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }
    .field-note-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: var(--muted);
    }
    .field-note-avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      border: 2px solid var(--gold);
      padding: 0.2rem;
      object-fit: cover;
      background: rgba(255, 255, 255, 0.05);
    }
    .field-note-quote {
      font-size: 1.15rem;
      line-height: 1.6;
      color: var(--muted);
    }
    .field-note-author {
      font-size: 1rem;
      font-weight: 600;
      margin-top: 0.75rem;
      color: var(--text);
    }
    .drop {
      margin-top: 1rem;
      padding: 5rem 1.5rem 6rem;
    }
    .drop-inner {
      background: radial-gradient(circle at top, rgba(10, 20, 45, 0.95), rgba(4, 9, 20, 0.95));
      border: 1px solid rgba(216, 180, 109, 0.35);
      border-radius: 32px;
      padding: 3rem;
      box-shadow: 0 40px 90px rgba(0, 0, 0, 0.5);
    }
    .drop .section-title {
      font-size: 2.6rem;
    }
    .drop form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
      padding: 1rem;
      border-radius: 28px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.03);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.02);
    }
    .drop form input,
    .drop form select {
      width: 100%;
      padding: 0.9rem 1.2rem;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      background: rgba(0, 0, 0, 0.3);
      color: var(--text);
      font-size: 0.95rem;
    }
    .drop form select {
      appearance: none;
      background-image: linear-gradient(45deg, transparent 50%, var(--gold) 50%), linear-gradient(135deg, var(--gold) 50%, transparent 50%);
      background-position: calc(100% - 20px) calc(50% + 2px), calc(100% - 14px) calc(50% + 2px);
      background-size: 6px 6px;
      background-repeat: no-repeat;
      padding-right: 2.5rem;
    }
    .drop .btn.primary {
      padding: 0.95rem 2.4rem;
      font-size: 0.95rem;
      letter-spacing: 0.18em;
      width: 100%;
    }
    #dropStateMessage {
      margin-bottom: 1rem;
      font-size: 1.05rem;
      color: var(--muted);
    }
    .form-note {
      margin-top: 1rem;
      color: var(--muted);
      font-size: 0.9rem;
    }
    .message {
      margin-top: 1rem;
      font-weight: 600;
    }
    .referral-link {
      margin-top: 0.5rem;
      color: var(--muted);
      font-size: 0.9rem;
    }
    .ceo-section {
      padding-top: 3rem;
      padding-bottom: 5rem;
    }
    .ceo-content {
      background: rgba(6, 12, 30, 0.85);
      border-radius: 30px;
      padding: 3rem;
      border: 1px solid rgba(216, 180, 109, 0.35);
      box-shadow: var(--shadow-base);
    }
    .ceo-content h2 {
      font-size: 2.4rem;
      margin-bottom: 0.5rem;
      position: relative;
      display: inline-block;
    }
    .ceo-content h2::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: -0.4rem;
      width: 80px;
      height: 2px;
      background: linear-gradient(90deg, var(--gold), transparent);
    }
    .ceo-content h3 {
      font-size: 1.2rem;
      color: var(--gold);
      margin-bottom: 1.5rem;
    }
    .weight-demo {
      margin-top: 3rem;
      padding: 2rem;
      border-radius: 24px;
      background: rgba(9, 17, 38, 0.95);
      box-shadow: var(--shadow-base);
    }
    .weight-demo h3 {
      margin-bottom: 1rem;
    }
    .weight-bars {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }
    .weight-row {
      display: grid;
      grid-template-columns: 130px 1fr 60px;
      align-items: center;
      gap: 0.75rem;
    }
    .weight-row .bar {
      height: 10px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.08);
      overflow: hidden;
    }
    .weight-row .bar-fill {
      display: block;
      height: 100%;
      width: 0;
      border-radius: inherit;
      transition: width 1.2s ease;
    }
    .bar-snooom .bar-fill {
      background: linear-gradient(90deg, #f7d18b, var(--gold));
    }
    .bar-typical .bar-fill {
      background: rgba(255, 255, 255, 0.3);
    }
    .weight-demo.visible .bar-snooom .bar-fill {
      width: 90%;
    }
    .weight-demo.visible .bar-typical .bar-fill {
      width: 55%;
    }
    .weight-caption {
      margin-top: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: var(--muted);
    }
    .access-code {
      margin-top: 0.75rem;
      font-family: 'Space Grotesk', system-ui, sans-serif;
      font-size: 0.95rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--cream);
      padding: 0.6rem 1rem;
      border-radius: 999px;
      border: 1px dashed rgba(255, 255, 255, 0.35);
      background: rgba(8, 21, 44, 0.7);
      display: inline-block;
    }
    footer {
      text-align: center;
      padding: 2.5rem 1rem;
      background: rgba(4, 9, 20, 0.95);
      border-top: 1px solid rgba(216, 180, 109, 0.3);
    }
    footer img {
      width: 48px;
      margin: 0 auto 1rem;
    }
    footer p {
      color: var(--muted);
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }
    .lightbox {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      z-index: 2000;
    }
    .lightbox.active {
      opacity: 1;
      pointer-events: all;
    }
    .lightbox-img {
      max-width: 90vw;
      max-height: 85vh;
      border-radius: 24px;
      box-shadow: var(--shadow-hover);
      transform: scale(0.95);
      transition: transform 0.35s ease;
    }
    .lightbox.active .lightbox-img {
      transform: scale(1);
    }
    .lightbox-close {
      position: absolute;
      top: 30px;
      right: 40px;
      font-size: 2rem;
      color: var(--cream);
      cursor: pointer;
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .reveal {
      opacity: 0;
      transform: translateY(40px);
    }
    .reveal.visible {
      animation: fadeUp 0.85s ease forwards;
    }
    @media (max-width: 768px) {
      nav {
        flex-direction: column;
      }
      .nav-links {
        flex-wrap: wrap;
        justify-content: center;
      }
      .hero {
        text-align: center;
      }
      .hero-actions {
        justify-content: center;
      }
      .drop-inner {
        padding: 2rem;
      }
      .field-notes-wrapper {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body id="top">
  <header>
    <nav>
      <a href="#top" class="logo">
        <img src="0475b64d-f67d-4a80-a3ab-bc20f79e3667.png" alt="SNOOOM logo" class="logo-img">
      </a>
      <div class="nav-links">
        <a href="#hero">Hero</a>
        <a href="#floating">Product</a>
        <a href="#details">Details</a>
        <a href="#drop">Drop</a>
        <a href="#ceo">CEO</a>
      </div>
    </nav>
  </header>
  <main>
    <section class="hero" id="hero">
      <div class="hero-text reveal">
        <p class="hero-label">Drop 01: The SNOOOM Hoodie</p>
        <p class="tagline">Vintage varsity. Modern comfort.</p>
        <h1>The SNOOOM Hoodie makes every hallway feel like a stadium tunnel.</h1>
        <p>Vintage varsity style with modern comfort.<br>The SNOOOM Hoodie is crafted for chilly mornings, late-night work sessions, and the everyday moments in between.</p>
        <div class="hero-actions">
          <a href="#floating" class="btn primary" id="hero-primary-cta" data-log-event="cta_click" data-log-location="hero_primary">Explore the drop</a>
          <a href="#drop" class="btn" id="hero-secondary-cta" data-log-event="cta_click" data-log-location="hero_secondary">Get early access</a>
        </div>
      </div>
      <div class="hero-image reveal hoodie-breathe">
        <img src="5a3e387b-fde8-4828-bc0c-25d11cc0f644.png" alt="SNOOOM Hoodie">
      </div>
    </section>

    <section id="floating">
      <div class="floating-section">
        <div class="floating-image reveal">
          <img id="parallax-hoodie" src="f8e37b5e-5e45-4191-b631-f3f9c22ba0f2.png" alt="SNOOOM floating hoodie">
        </div>
        <div class="floating-copy reveal">
          <h2>The varsity hoodie, remixed.</h2>
          <p>Structured shoulders, retro ribbing, and a plush brushed interior create a silhouette that feels nostalgic yet future-ready. Every stitch was mapped for longevity.</p>
          <div class="drop-badge">DROPPING SOON</div>
          <div class="size-selector">
            <button type="button">S</button>
            <button type="button">M</button>
            <button type="button">L</button>
            <button type="button">XL</button>
            <button type="button">XXL</button>
          </div>
          <div class="quantity-selector">
            <button type="button" class="qty-btn minus">−</button>
            <span class="qty-number" id="qty-number">1</span>
            <button type="button" class="qty-btn plus">+</button>
          </div>
          <div class="floating-buttons">
            <a href="#drop" class="btn primary" data-log-event="cta_click" data-log-location="product_primary">Get early access</a>
            <a href="#details" class="btn" data-log-event="cta_click" data-log-location="product_secondary">View details</a>
          </div>
          <div class="gallery-thumbs">
            <img class="thumbnail lightbox-trigger" src="f899a50a-1633-4531-9858-e91c937b86bc.png" alt="SNOOOM Hoodie detail">
            <img class="thumbnail lightbox-trigger" src="beb850c2-99cd-4314-9be8-5acffd895c13.png" alt="SNOOOM Hoodie detail">
            <img class="thumbnail lightbox-trigger" src="415d54f5-2d00-4d12-b3bd-288473a8e9ca.png" alt="SNOOOM Hoodie detail">
            <img class="thumbnail lightbox-trigger" src="80adef90-1e9f-4acb-b876-aeb14d318391.png" alt="SNOOOM Hoodie detail">
          </div>
        </div>
      </div>
    </section>

    <section class="showcase" id="showcase">
      <h2 class="section-title reveal">Showcase</h2>
      <img class="reveal lightbox-trigger" src="80adef90-1e9f-4acb-b876-aeb14d318391.png" alt="SNOOOM Hoodie showcase">
      <p class="reveal">Layered hues of midnight navy and aged cream reference classic varsity banners, while the updated tailoring keeps everything clean and contemporary.</p>
    </section>

    <section class="features" id="features">
      <h2 class="section-title reveal">Features</h2>
      <div class="feature-grid">
        <article class="card reveal">
          <h3>Vintage varsity look</h3>
          <p>Inspired by collegiate warm-ups with bold taping, ribbed cuffs, and the SNOOOM crest stitched using metallic threads.</p>
        </article>
        <article class="card reveal">
          <h3>Heavyweight comfort</h3>
          <p>400g heavyweight fleece with a brushed interior delivers warmth without bulk — perfect for early mornings, cold commutes, and late-night sessions.</p>
        </article>
        <article class="card reveal">
          <h3>Longevity</h3>
          <p>Reinforced seams and double-needle stitching keep the structure crisp wash after wash.</p>
        </article>
        <article class="card reveal">
          <h3>Everyday essential</h3>
          <p>Minimal branding and tonal palette make it easy to pair with denim, tailoring, or athleisure.</p>
        </article>
      </div>
      <div class="weight-demo reveal">
        <h3>Built with real weight</h3>
        <div class="weight-bars">
          <div class="weight-row">
            <span class="label">SNOOOM Hoodie</span>
            <div class="bar bar-snooom"><span class="bar-fill"></span></div>
            <span class="value">400g</span>
          </div>
          <div class="weight-row">
            <span class="label">Typical hoodie</span>
            <div class="bar bar-typical"><span class="bar-fill"></span></div>
            <span class="value">250g</span>
          </div>
        </div>
        <p class="weight-caption">Heavy. Durable. Real.</p>
      </div>
    </section>

    <section class="closeup" id="closeup">
      <h2 class="section-title reveal">Close-up Grid</h2>
      <div class="closeup-grid">
        <img class="reveal lightbox-trigger" src="80adef90-1e9f-4acb-b876-aeb14d318391.png" alt="Close-up 1">
        <img class="reveal lightbox-trigger" src="415d54f5-2d00-4d12-b3bd-288473a8e9ca.png" alt="Close-up 2">
        <img class="reveal lightbox-trigger" src="f899a50a-1633-4531-9858-e91c937b86bc.png" alt="Close-up 3">
        <img class="reveal lightbox-trigger" src="beb850c2-99cd-4314-9be8-5acffd895c13.png" alt="Close-up 4">
      </div>
    </section>

    <section class="details" id="details">
      <h2 class="section-title reveal">Details</h2>
      <div class="details-tabs">
        <button class="tab-btn active" data-tab="material">Material</button>
        <button class="tab-btn" data-tab="fit">Fit &amp; Feel</button>
        <button class="tab-btn" data-tab="wash">Wash &amp; Care</button>
      </div>
      <div class="tab-content" id="tab-content"></div>
    </section>

    <section class="size-guide" id="size-guide">
      <h2 class="section-title reveal">Size Guide</h2>
      <p class="reveal">Choose your fit using height and weight pairings based on the SNOOOM Hoodie wear-test crew.</p>
      <div class="card reveal">
        <h3>Men</h3>
        <table>
          <tr><th>Size</th><th>Weight</th><th>Height</th></tr>
          <tr><td>S</td><td>55–65 kg</td><td>160–172 cm</td></tr>
          <tr><td>M</td><td>65–75 kg</td><td>170–178 cm</td></tr>
          <tr><td>L</td><td>75–85 kg</td><td>176–185 cm</td></tr>
          <tr><td>XL</td><td>85–95 kg</td><td>183–192 cm</td></tr>
          <tr><td>XXL</td><td>95–110 kg</td><td>190–200 cm</td></tr>
        </table>
      </div>
      <div class="card reveal" style="margin-top:1.5rem;">
        <h3>Women</h3>
        <table>
          <tr><th>Size</th><th>Weight</th><th>Height</th></tr>
          <tr><td>S</td><td>45–55 kg</td><td>150–165 cm</td></tr>
          <tr><td>M</td><td>55–65 kg</td><td>160–172 cm</td></tr>
          <tr><td>L</td><td>65–75 kg</td><td>168–178 cm</td></tr>
          <tr><td>XL</td><td>75–90 kg</td><td>175–185 cm</td></tr>
          <tr><td>XXL</td><td>90–105 kg</td><td>180–190 cm</td></tr>
        </table>
      </div>
    </section>

    <section class="about" id="about">
      <h2 class="section-title reveal">About SNOOOM</h2>
      <div class="about-content">
        <div class="reveal">
          <p>SNOOOM merges timeless varsity cues with modern comfort. Our pieces stay sharp for early starts, late nights, and everything that unfolds in between.</p>
          <p>Crafted in small batches with premium materials, the SNOOOM Hoodie is for people who want versatile essentials built to last. Be part of the movement before it becomes the trend.</p>
        </div>
        <div class="reveal">
          <img class="lightbox-trigger" src="f899a50a-1633-4531-9858-e91c937b86bc.png" alt="SNOOOM Hoodie lifestyle">
        </div>
      </div>
    </section>

    <section class="testimonials field-notes" id="testimonials">
      <h2 class="section-title reveal">Field Notes</h2>
      <div class="field-notes-wrapper">
        <div class="field-note-stack-wrapper">
          <div class="field-note-stack" id="field-note-stack"></div>
          <div class="notes-progress-bar">
            <div class="notes-progress-fill" id="notes-progress"></div>
          </div>
        </div>
        <div class="field-notes-visual reveal">
          <img class="lightbox-trigger" src="415d54f5-2d00-4d12-b3bd-288473a8e9ca.png" alt="SNOOOM Hoodie in the wild">
        </div>
      </div>
    </section>

    <section class="drop" id="drop">
      <div class="drop-inner reveal">
        <h2 class="section-title">Drop List</h2>
        <p id="dropStateMessage">The SNOOOM Hoodie is dropping soon. Join the list and get early access plus styling inspiration straight to your inbox.</p>
        <form id="notify-form">
          <input type="text" id="signup-name" placeholder="Your name" autocomplete="name" required>
          <input type="email" id="email" placeholder="you@email.com" autocomplete="email" required>
          <select id="signup-size" required>
            <option value="">Select size</option>
            <option value="S">S</option>
            <option value="M">M</option>
            <option value="L">L</option>
            <option value="XL">XL</option>
            <option value="XXL">XXL</option>
          </select>
          <button type="submit" class="btn primary" id="dropSubmit" data-log-event="cta_click" data-log-location="drop_form">Get early access</button>
        </form>
        <p class="form-note">No spam. Just drop dates and styling inspo.</p>
        <p class="message" id="formMessage"></p>
        <p id="accessCode" class="access-code"></p>
        <p id="referralLink" class="referral-link"></p>
      </div>
    </section>

    <section id="ceo" class="ceo-section">
      <div class="ceo-content reveal">
        <h2>Meet the Founder</h2>
        <h3>Aaron Lyons — CEO &amp; Creative Lead</h3>
        <p class="ceo-story">
          SNOOOM started because I could never find a hoodie that actually fit my life. Everything was either cheap, too loud, or just didn’t feel right. I wanted something I could wear to school, chill in, travel in, go out in — all without switching fits.
          <br><br>
          Nothing hit the way I wanted, so I made it myself. SNOOOM is built for people who want something clean, solid, and versatile without trying too hard.
          <br><br>
          The goal was simple: make a hoodie that becomes your everyday one — the piece you grab without thinking because it always looks and feels right.
        </p>
      </div>
    </section>
  </main>

  <footer>
    <img src="0475b64d-f67d-4a80-a3ab-bc20f79e3667.png" alt="SNOOOM logo">
    <p>© SNOOOM. Crafted for late nights &amp; early mornings.</p>
  </footer>

  <div id="lightbox" class="lightbox">
    <span class="lightbox-close">&times;</span>
    <img class="lightbox-img" src="" alt="Expanded view">
  </div>


  <script>
    const revealObserver = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.2 });

    document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));

    const tabContent = document.getElementById('tab-content');
    const tabs = document.querySelectorAll('.tab-btn');
    const tabCopy = {
      material: `
        <div>
          <p><strong>Material</strong></p>
          <ul>
            <li>80% premium brushed cotton</li>
            <li>20% durable polyester for structure</li>
            <li>Heavyweight fleece interior for maximum comfort</li>
            <li>High-density embroidered “SNOOOM” chest graphic</li>
            <li>Reinforced hood and pocket stitching for longevity</li>
          </ul>
        </div>
      `,
      fit: `
        <div>
          <p><strong>Fit &amp; Feel</strong></p>
          <ul>
            <li>Relaxed, slightly oversized streetwear fit</li>
            <li>Structured hood that holds its shape</li>
            <li>Soft inside, smooth outside</li>
            <li>Ribbed cuffs and hem for a clean silhouette</li>
          </ul>
        </div>
      `,
      wash: `
        <div>
          <p><strong>Wash &amp; Care</strong></p>
          <ul>
            <li>Machine wash cold (30°C)</li>
            <li>Turn inside out to protect embroidery</li>
            <li>Use mild detergent</li>
            <li>No bleach</li>
            <li>Tumble dry low or hang dry</li>
            <li>Do not iron embroidery</li>
          </ul>
        </div>
      `
    };

    if (tabContent) {
      tabContent.innerHTML = tabCopy.material;
    }

    tabs.forEach(btn => {
      btn.addEventListener('click', () => {
        tabs.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        tabContent.innerHTML = tabCopy[btn.dataset.tab];
      });
    });

    const notifyForm = document.getElementById('notify-form');
    const nameInput = document.getElementById('signup-name');
    const emailInput = document.getElementById('email');
    const sizeSelect = document.getElementById('signup-size');
    const message = document.getElementById('formMessage');
    const accessCodeEl = document.getElementById('accessCode');
    const referralLinkEl = document.getElementById('referralLink');
    const dropStateMessageEl = document.getElementById('dropStateMessage');
    const heroSecondaryCta = document.getElementById('hero-secondary-cta');
    const dropSubmitBtn = document.getElementById('dropSubmit');
    const referralParam = new URLSearchParams(window.location.search).get('ref');

    const clientIdKey = 'snooom-user-id';
    let clientId = localStorage.getItem(clientIdKey);
    if (!clientId) {
      clientId = crypto.randomUUID ? crypto.randomUUID() : `${Date.now()}-${Math.random().toString(16).slice(2)}`;
      localStorage.setItem(clientIdKey, clientId);
    }

    function logEvent(type, metadata = {}) {
      const payload = JSON.stringify({ type, userId: clientId, metadata });
      if (typeof navigator !== 'undefined' && navigator.sendBeacon) {
        const blob = new Blob([payload], { type: 'application/json' });
        navigator.sendBeacon('/api/events', blob);
        return;
      }
      fetch('/api/events', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: payload,
        keepalive: true
      }).catch(() => {});
    }

    logEvent('page_view', { ref: referralParam || null });

    document.querySelectorAll('[data-log-event]').forEach(el => {
      el.addEventListener('click', () => {
        logEvent(el.dataset.logEvent, { location: el.dataset.logLocation || 'cta' });
      });
    });

    const trackedSections = ['hero', 'floating', 'drop'];
    const seenSections = new Set();
    const sectionObserver = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting && entry.target.id && !seenSections.has(entry.target.id)) {
          seenSections.add(entry.target.id);
          logEvent('section_view', { section: entry.target.id });
        }
      });
    }, { threshold: 0.55 });
    trackedSections.forEach(id => {
      const el = document.getElementById(id);
      if (el) sectionObserver.observe(el);
    });

    async function hydrateDropState() {
      try {
        const res = await fetch('/api/drop-state');
        if (!res.ok) throw new Error('network');
        const state = await res.json();
        if (dropStateMessageEl) dropStateMessageEl.textContent = state.message;
        applyCtaState(state.state);
        logEvent('drop_state', { state: state.state });
      } catch (err) {
        if (dropStateMessageEl) {
          dropStateMessageEl.textContent = 'Waitlist is open. Confirm your spot to get early access.';
        }
        applyCtaState('waitlist');
      }
    }

    function applyCtaState(state) {
      if (!heroSecondaryCta || !dropSubmitBtn) return;
      if (state === 'live') {
        heroSecondaryCta.textContent = 'Buy now';
        dropSubmitBtn.textContent = 'Buy now';
      } else if (state === 'post') {
        heroSecondaryCta.textContent = 'Join next drop';
        dropSubmitBtn.textContent = 'Join next drop';
      } else {
        heroSecondaryCta.textContent = 'Get early access';
        dropSubmitBtn.textContent = 'Get early access';
      }
    }

    notifyForm?.addEventListener('submit', async e => {
      e.preventDefault();
      if (!nameInput || !emailInput || !sizeSelect) return;
      const payload = {
        name: nameInput.value.trim(),
        email: emailInput.value.trim(),
        size: sizeSelect.value,
        referralCode: referralParam || undefined
      };
      if (!payload.name || !payload.email || !payload.size) {
        if (message) {
          message.textContent = 'Add your name, email, and size to lock in your spot.';
          message.style.color = '#ff7b7b';
        }
        return;
      }
      const submitButton = dropSubmitBtn || notifyForm.querySelector('button[type="submit"]');
      if (message) {
        message.textContent = 'Processing...';
        message.style.color = '#d1a655';
      }
      if (submitButton) submitButton.disabled = true;
      try {
        const res = await fetch('/api/signups', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        if (!res.ok) throw new Error(data.error || 'Unable to save signup.');
        if (message) {
          message.textContent = data.message;
          message.style.color = '#d1a655';
        }
        if (accessCodeEl) {
          accessCodeEl.textContent = data.earlyAccessCode ? `Your Early Access Code: ${data.earlyAccessCode}` : '';
        }
        if (referralLinkEl) {
          referralLinkEl.innerHTML = data.referralLink ? `Share your link: <a href="${data.referralLink}" target="_blank" rel="noreferrer">${data.referralLink}</a>` : '';
        }
        logEvent('waitlist_submitted', { status: 'success', size: payload.size });
        notifyForm.reset();
      } catch (err) {
        if (message) {
          message.textContent = err.message || 'Unable to save signup right now.';
          message.style.color = '#ff7b7b';
        }
        if (accessCodeEl) accessCodeEl.textContent = '';
        if (referralLinkEl) referralLinkEl.textContent = '';
        logEvent('waitlist_submitted', { status: 'error' });
      } finally {
        if (submitButton) submitButton.disabled = false;
      }
    });

    document.querySelectorAll('.btn').forEach(btn => {
      btn.addEventListener('click', e => {
        const rect = btn.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        const ripple = document.createElement('span');
        ripple.className = 'ripple';
        ripple.style.width = ripple.style.height = `${size}px`;
        ripple.style.left = `${e.clientX - rect.left - size / 2}px`;
        ripple.style.top = `${e.clientY - rect.top - size / 2}px`;
        btn.appendChild(ripple);
        ripple.addEventListener('animationend', () => ripple.remove());
      });
    });

    const hoodie = document.getElementById('parallax-hoodie');
    let parallaxTarget = 0;
    let parallaxCurrent = 0;
    let parallaxRAF = null;

    const updateParallax = () => {
      parallaxCurrent += (parallaxTarget - parallaxCurrent) * 0.08;
      if (hoodie) hoodie.style.transform = `translateY(${parallaxCurrent}px)`;
      if (Math.abs(parallaxTarget - parallaxCurrent) > 0.1) {
        parallaxRAF = requestAnimationFrame(updateParallax);
      } else {
        parallaxRAF = null;
      }
    };

    window.addEventListener('scroll', () => {
      parallaxTarget = window.scrollY * 0.05;
      if (!parallaxRAF) {
        parallaxRAF = requestAnimationFrame(updateParallax);
      }
    });

    const qtyNumberEl = document.getElementById('qty-number');
    const qtyButtons = document.querySelectorAll('.quantity-selector .qty-btn');
    let qtyValue = 1;
    const updateQtyDisplay = () => {
      if (qtyNumberEl) qtyNumberEl.textContent = qtyValue;
    };
    qtyButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        if (btn.classList.contains('plus')) {
          qtyValue += 1;
        } else {
          qtyValue = Math.max(1, qtyValue - 1);
        }
        updateQtyDisplay();
      });
    });

    const fallbackFieldNotes = [
      { quote: '“Feels like something you’d thrift once and never find again. The weight, the drape—everything just clicks.”', author: 'Nate · Visual Designer' },
      { quote: '“Has that old athletic department energy, but cleaned up. Like a hoodie they would’ve kept locked in the archives.”', author: 'Lex · Creative Runner' },
      { quote: '“Wore it from a coffee run to a night session in the studio. Never stretched out, never lost shape.”', author: 'Mila · Photographer' },
      { quote: '“The embroidery hits in person. People keep asking where it’s from every time I wear it.”', author: 'Dre · DJ & Curator' },
      { quote: '“This is the hoodie I grab when I don’t want to overthink the outfit but still want it to feel intentional.”', author: 'Talia · Art Director' },
      { quote: '“It has that vintage varsity DNA, but the fit is modern and clean. Not loud, just confident.”', author: 'Sage · Creative Consultant' },
      { quote: '“Put it on for a flight and kept it on all weekend. Warm, heavy, and weirdly reassuring.”', author: 'Emi · DJ & Stylist' },
      { quote: '“The hood actually holds its shape. No floppy sides, no weird collapse. It frames your face properly.”', author: 'Jordan · Creative Director' },
      { quote: '“The inside feels like brushed fleece, the outside looks structured and sharp. It photographs insanely well.”', author: 'Kei · Filmmaker' },
      { quote: '“Finally a hoodie that works for meetings, late-night drives, and early shoots without feeling try-hard.”', author: 'Lina · Founder' },
      { quote: '“It hangs off the shoulders perfectly. Relaxed, but not sloppy. You can tell someone obsessed over the fit.”', author: 'Max · Stylist' },
      { quote: '“The kind of hoodie that makes jeans, cargos, or sweats all feel like a full fit.”', author: 'Ro · Brand Strategist' },
      { quote: '“Even after a few washes, the embroidery still looks crisp and raised. No sagging, no fuzz.”', author: 'Cam · Textile Designer' },
      { quote: '“You put it on and instantly get that ‘archive piece’ feeling, like it already has a story.”', author: 'Imani · Writer' },
      { quote: '“Heavy enough for late-night walks, soft enough to crash on the sofa in. Basically lives on my chair now.”', author: 'Eli · Producer' },
      { quote: '“The navy, cream and red combo just feels right. Classic but still different from what everyone else is wearing.”', author: 'Noor · Creative Assistant' },
      { quote: '“It layers over tees and under coats without bunching. Whoever designed the pattern knew what they were doing.”', author: 'Jay · Art Student' },
      { quote: '“Every time I go to hang it back up, I end up putting it back on. That’s the kind of piece this is.”', author: 'Hana · Curator' },
      { quote: '“The ribbing at the cuffs and hem actually does its job. The silhouette stays clean all day.”', author: 'Luca · Motion Designer' },
      { quote: '“It feels built for late nights, early mornings, and everything in between. Quiet, solid, reliable.”', author: 'Kai · Creative Producer' }
    ];

    const fieldNoteStack = document.getElementById('field-note-stack');
    const progressFill = document.getElementById('notes-progress');
    const fieldNotesSection = document.querySelector('.field-notes');
    const avatarSrc = 'f8e37b5e-5e45-4191-b631-f3f9c22ba0f2.png';
    let fieldNoteCards = [];
    let currentNote = 0;
    let noteInterval = null;

    async function loadFieldNotes() {
      let data = [];
      try {
        const res = await fetch('/api/field-notes');
        if (!res.ok) throw new Error('network');
        data = await res.json();
      } catch (err) {
        data = fallbackFieldNotes;
      }
      renderFieldNotes(data);
    }

    function renderFieldNotes(notes) {
      if (!fieldNoteStack) return;
      fieldNoteStack.innerHTML = '';
      notes.forEach((note, index) => {
        const card = document.createElement('article');
        card.className = 'field-note-card' + (index === 0 ? ' active' : '');
        card.innerHTML = `
          <div class="field-note-header">
            <img src="${avatarSrc}" alt="SNOOOM Hoodie" class="field-note-avatar">
            <span>Field note</span>
          </div>
          <p class="field-note-quote">${note.quote}</p>
          <span class="field-note-author">${note.author}</span>
        `;
        fieldNoteStack.appendChild(card);
      });
      fieldNoteCards = Array.from(fieldNoteStack.children);
      currentNote = 0;
      triggerProgress();
      if (fieldNotesSection) {
        const rect = fieldNotesSection.getBoundingClientRect();
        if (rect.top < window.innerHeight && rect.bottom > 0) {
          stopNoteRotation();
          startNoteRotation();
        }
      }
    }

    const notesObserver = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.target !== fieldNotesSection) return;
        if (entry.isIntersecting) {
          startNoteRotation();
        } else {
          stopNoteRotation();
        }
      });
    }, { threshold: 0.4 });

    function triggerProgress() {
      if (!progressFill) return;
      progressFill.classList.remove('animating');
      void progressFill.offsetWidth;
      progressFill.classList.add('animating');
    }

    function setActiveNote(index) {
      if (!fieldNoteCards.length) return;
      fieldNoteCards.forEach((card, idx) => {
        card.classList.toggle('active', idx === index);
      });
      triggerProgress();
      logEvent('field_note_rotate', { index });
    }

    function startNoteRotation() {
      if (!fieldNoteCards.length || noteInterval) return;
      setActiveNote(currentNote);
      noteInterval = setInterval(() => {
        currentNote = (currentNote + 1) % fieldNoteCards.length;
        setActiveNote(currentNote);
      }, 6500);
    }

    function stopNoteRotation() {
      if (!noteInterval) return;
      clearInterval(noteInterval);
      noteInterval = null;
      if (progressFill) progressFill.classList.remove('animating');
    }

    if (fieldNotesSection) {
      notesObserver.observe(fieldNotesSection);
    }

    loadFieldNotes();
    hydrateDropState();

    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.querySelector('.lightbox-img');
    const lightboxClose = document.querySelector('.lightbox-close');
    let currentLightboxIndex = -1;

    const getLightboxTriggers = () => Array.from(document.querySelectorAll('.lightbox-trigger'));
    let lightboxTriggers = getLightboxTriggers();

    const openLightbox = index => {
      lightboxTriggers = getLightboxTriggers();
      currentLightboxIndex = index;
      const target = lightboxTriggers[index];
      if (!target) return;
      lightboxImg.src = target.getAttribute('src');
      lightboxImg.alt = target.getAttribute('alt') || 'Expanded view';
      lightbox.classList.add('active');
      logEvent('gallery_open', { src: lightboxImg.src });
    };

    const closeLightbox = () => {
      lightbox.classList.remove('active');
      lightboxImg.src = '';
      currentLightboxIndex = -1;
    };

    const refreshLightboxTriggers = () => {
      lightboxTriggers = getLightboxTriggers();
      lightboxTriggers.forEach((img, index) => {
        if (!img.dataset.lightboxBound) {
          img.dataset.lightboxBound = 'true';
          img.addEventListener('click', () => openLightbox(index));
        }
      });
    };

    refreshLightboxTriggers();

    lightbox.addEventListener('click', e => {
      if (e.target === lightbox || e.target === lightboxClose) {
        closeLightbox();
      }
    });

    document.addEventListener('keydown', e => {
      if (!lightbox.classList.contains('active')) return;
      if (e.key === 'Escape') {
        closeLightbox();
      }
      if (e.key === 'ArrowRight') {
        currentLightboxIndex = (currentLightboxIndex + 1) % lightboxTriggers.length;
        openLightbox(currentLightboxIndex);
      }
      if (e.key === 'ArrowLeft') {
        currentLightboxIndex = (currentLightboxIndex - 1 + lightboxTriggers.length) % lightboxTriggers.length;
        openLightbox(currentLightboxIndex);
      }
    });
  </script>

</body>
</html>
